!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("_"),require("tartan")):"function"==typeof define&&define.amd?define(["_","tartan"],t):"object"==typeof exports?exports.tartanProcessing=t(require("_"),require("tartan")):e.tartanProcessing=t(e._,e.tartan)}(this,function(e,t){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var r=n(1),i=n(2);r.extend(e.exports,n(3)),e.exports.filter=n(4),e.exports.transform=n(5),r.extend(i.filter,e.exports.filter),r.extend(i.transform,e.exports.transform)},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports={version:"1.0.0"}},function(e,t){"use strict"},function(e,t,n){"use strict";e.exports.flattenSimpleBlocks=n(6),e.exports.fold=n(7),e.exports.mergeStripes=n(8),e.exports.removeEmptyBlocks=n(9),e.exports.removeZeroWidthStripes=n(10),e.exports.optimize=n(11)},function(e,t,n){"use strict";function r(e){var t=null,n=!0;return c.each(e.items,function(e){if(e.isStripe){if(0==e.count)return;if(null===t)return void(t=e.name);if(e.name==t)return}return n=!1,!1}),n&&null!==t&&(e=a.sett.reflectAndRepeat(e),e.items=[a.node.newStripe(a.token.newStripe(t,c.sumBy(e.items,function(e){return e.count})))]),e}function i(e){return e=c.clone(e),e.items=c.chain(e.items).reduce(function(e,t){return t.isBlock&&!t.isRoot&&!t.reflect&&t.repeat<=1?[].push.apply(e,t.items):e.push(t),e},[]).map(function(e){if(e.isBlock){if(0==e.items.length)return null;if(e=i(e),0==e.items.length)return null;if(1==e.items.length)return c.first(e.items)}return e}).filter().value(),r(e)}function o(e){var t=c.clone(e),n=e.warp==e.weft;return c.isObject(e.warp)&&(t.warp=i(e.warp)),c.isObject(e.weft)&&(n?t.weft=t.warp:t.weft=i(e.weft)),t}function s(){return o}var c=n(1),a=n(2).utils;e.exports=s},function(e,t,n){"use strict";function r(e){if(!(e.length<5||e.length%2!=1)){for(var t,n,r=[],i=0,o=e.length-1;;){if(t=e[i],n=e[o],!w.node.isSameNode(t,n))return;if(r.push(t),i==o)break;i++,o--}return r}}function i(e,t,n){if(!e.reflect&&0!=e.items.length){var i=m.concat(e.items,e.items[0]),o=r(i);if(m.isArray(o)){var s=m.clone(e);s.items=o,s.reflect=!0,n.push({node:s,hash:w.node.calculateNodeHash(s),weight:t.calculateNodeWeight(s)})}}}function o(e,t){var n=[e];if(e.reflect||0==e.items.length||!t.allowRootReorder)return n;var r,i=m.clone(e.items);for(r=0;r<i.length-1;r++){var o=i[0];i.splice(0,1),i.push(o);var s=m.clone(e);s.items=m.clone(i),n.push(s)}return n}function s(e,t,n,r){if(n.push(e),!(r<=0)&&e.length>=2*t.minBlockSize-1)for(var i=t.minBlockSize-1,o=e.length-t.minBlockSize,s=i;s<=o;s++)a(s,e,m.extend({},t,{allowSplitStripe:!1}),n,r-1),t.allowSplitStripe&&a(s,e,m.extend({},t,{allowSplitStripe:!0}),n,r-1)}function c(e,t,n,r,i,o,c,a,l){if(!(r.length<c.minBlockSize)){var u=e.slice(0,t>=0?t+1:0);i&&u.push(i);var f=[];s(r,c,f,l);var p=e.slice(n,e.length);o&&p.splice(0,0,o);var h=[];s(p,c,h,l),m.each(h,function(e){m.each(f,function(t){a.push(m.concat(u,w.node.newBlock(t,!0),e))})})}}function a(e,t,n,r,i){var o,s;o=e-1,s=e+1;for(var a=null,l=null,u=[t[e]],f=!1;o>=0&&s<t.length;){if(!w.node.isSameNode(t[o],t[s])){if(n.allowSplitStripe&&t[o].isStripe&&t[s].isStripe&&t[o].name==t[s].name){var p=t[o].count-t[s].count;p>0?a=w.node.newStripe({name:t[o].name,count:Math.abs(p)}):l=w.node.newStripe({name:t[o].name,count:Math.abs(p)});var h=m.clone(t[o]);h.count=Math.min(t[o].count,t[s].count),u.splice(0,0,h),o--,s++,f=!0;break}f=!0;break}u.splice(0,0,t[o]),o--,s++,n.greedy&&c(t,o,s,u,a,l,n,r,i)}!f&&n.greedy||c(t,o,s,u,a,l,n,r,i)}function l(e,t,n){if(!(e.items.length<2*t.minBlockSize-1)){var r=[];s(e.items,t,r,t.maxFoldLevels),m.each(r,function(r){var i=m.clone(e);i.items=r,n.push({node:i,hash:w.node.calculateNodeHash(i),weight:t.calculateNodeWeight(i)})})}}function u(e,t,n){if(n.push(e),t.allowNestedBlocks&&t.processExistingBlocks&&t.maxFoldLevels>1){var r=[],i=[],o=m.clone(t);o.allowRootReorder=!1,o.maxFoldLevels-=1,m.each(e.items,function(e){if(e.isBlock){e=m.clone(e),e.isRoot=!0;var t=f(e,o,!0),n=r;r=[],m.each(t,function(e){e=m.clone(e.node),e.isRoot=!1,n.length>0?m.each(n,function(t){r.push(m.concat(t,i,e))}):r.push(m.concat(i,e))}),i=[]}else i.push(e)}),m.each(r,function(t){var r=m.clone(e);r.items=m.concat(t,i),n.push(r)})}}function f(e,t,n){var r=[{node:e,hash:w.node.calculateNodeHash(e),weight:t.calculateNodeWeight(e)}],s=[];u(e,t,s);var c=[];return m.each(s,function(e){var n=o(e,t);m.each(m.drop(n),function(e){c.push({hash:w.node.calculateNodeHash(e)})}),m.each(n,function(e){i(e,t,r),t.allowNestedBlocks&&l(e,t,r)})}),m.chain(r).differenceBy(c,function(e){return e.hash}).uniqBy(function(e){return e.hash}).sortBy(function(e){return e.weight}).each(function(e){n||console.log(e.weight.toFixed(4),e.hash.replace(/\[R\*[0-9]+\/R[PF]:/g,"").replace(/B\*[0-9]+\/R[PF]:/g,"").replace(/]$/g,"").replace(/[0-9]+/g,""))}).value()}function p(e,t){var n=m.clone(e),r=e.warp===e.weft;return m.isObject(e.warp)&&(n.warpVariants=f(e.warp,t,!0)),m.isObject(e.weft)&&(r?n.weftVariants=n.warpVariants:n.weftVariants=f(e.weft,t,!0)),n.warp=m.first(n.warpVariants).node,n.weft=m.first(n.weftVariants).node,n}function h(e){return e=m.extend({},d,e),e.minBlockSize<1&&(e.minBlockSize=1),e.maxFoldLevels<=0&&(e.maxFoldLevels=2e8),function(t){return p(t,e)}}var m=n(1),w=n(2).utils,d={allowRootReorder:!0,allowNestedBlocks:!1,maxFoldLevels:2,minBlockSize:3,greedy:!1,allowSplitStripe:!0,processExistingBlocks:!0,calculateNodeWeight:w.node.calculateNodeWeight};e.exports=h},function(e,t,n){"use strict";function r(e){var t=e.reflect&&(e.isRoot||e.repeat>1)?s.first(e.items):null,n=e.reflect?s.last(e.items):null;return e=s.clone(e),e.items=s.reduce(e.items,function(e,i){if(i.isBlock)return e.push(r(i)),e;if(i.isStripe){if(i===n)return e.push(i),e;var o=s.last(e);if(o&&o.isStripe&&o!==t&&o.name==i.name)return o=s.clone(e.pop()),o.count+=i.count,e.push(o),e}return e.push(i),e},[]),e}function i(e,t){var n=s.clone(e),i=e.warp===e.weft;return s.isObject(e.warp)&&(n.warp=r(e.warp,t)),s.isObject(e.weft)&&(i?n.weft=n.warp:n.weft=r(e.weft,t)),n}function o(){return i}var s=n(1);e.exports=o},function(e,t,n){"use strict";function r(e){return e=s.clone(e),e.items=s.chain(e.items).map(function(e){return e.isBlock?(e=r(e),e.items.length>0?e:null):e}).filter().value(),e}function i(e){var t=s.clone(e),n=e.warp==e.weft;return s.isObject(e.warp)&&(t.warp=r(e.warp)),s.isObject(e.weft)&&(n?t.weft=t.warp:t.weft=r(e.weft)),t}function o(){return i}var s=n(1);e.exports=o},function(e,t,n){"use strict";function r(e,t){var n=e.reflect&&(e.isRoot||e.repeat>1)?s.first(e.items):null,i=e.reflect?s.last(e.items):null;if(e=s.clone(e),e.items=s.chain(e.items).map(function(e){return e.isBlock?(e=r(e,t),e.items.length>0?e:null):e.isStripe?e.count>0?e:!t.keepZeroWidthPivots||e!==n&&e!==i?null:e:e}).filter().value(),e.items.length>=2&&(i=s.last(e.items),i.isStripe&&i.count<=0)){e.items.pop();var o=s.last(e.items);o.isStripe?o.count*=2:e.items.push(i)}return e}function i(e,t){var n=s.clone(e),i=e.warp==e.weft;return s.isObject(e.warp)&&(n.warp=r(e.warp,t)),s.isObject(e.weft)&&(i?n.weft=n.warp:n.weft=r(e.weft,t)),n}function o(e){return e=s.extend({},c,e),function(t){return i(t,e)}}var s=n(1),c={keepZeroWidthPivots:!0};e.exports=o},function(e,t,n){"use strict";function r(e,t){return e=a()(e),t.simplifyBlocks&&(e=s()(e)),e=l(t)(e),t.simplifyStripes&&(e=c()(e)),e}function i(e){return e=o.extend({},u,e),function(t){return r(t,e)}}var o=n(1),s=n(6),c=n(8),a=n(9),l=n(10),u={simplifyBlocks:!0,simplifyStripes:!0};e.exports=i}])});
//# sourceMappingURL=tartan-processing.min.js.map